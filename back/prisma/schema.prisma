generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Language {
  EN
  PT
  ES
}

enum MusicApi {
  LETRAS
  VAGALUME
  MUSIXMATCH
}

model Room {
  id          String      @id @default(uuid())
  code        String      @unique
  password    String?
  maxRounds   Int         @default(10)
  maxPlayers  Int         @default(4)
  active      Boolean     @default(false) // Indica se o jogo está ativo
  gameState   GameState?  @relation("RoomToGameState") // Apenas o nome da relação aqui
  gameStateId String?     // Relaciona o estado do jogo
  language    Language    @default(EN)
  musicApi    MusicApi    @default(MUSIXMATCH)
  players     Player[]    // Jogadores na sala
}

model Player {
  id        String      @id @default(uuid())
  name      String
  score     Int         @default(0)
  isHost    Boolean     @default(false)
  avatar    String?
  roomId    String?
  room      Room?       @relation(fields: [roomId], references: [id])
}

model GameState {
  id            String   @id @default(uuid())
  currentRound  Int      @default(1)
  currentWord   String?
  timer         Int      @default(30)
  roomId        String   @unique
  room          Room     @relation("RoomToGameState", fields: [roomId], references: [id]) // Apenas `fields` e `references` aqui
}

model Word {
  id        String    @id @default(uuid())
  word      String
  language  Language
}

///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////
///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////

// enum RoomState {
//   OPEN
//   CLOSED
//   IN_PROGRESS
// }

// model Language {
//   id       Int    @id @default(autoincrement())
//   language String
//   Room     Room[]
//   Word     Word[]
// }

// model Room {
//   id              Int        @id @default(autoincrement())
//   code            String     @unique
//   password        String?
//   state           RoomState?
//   language_id     Int?
//   language        Language?  @relation(fields: [language_id], references: [id])
//   max_players     Int?
//   max_rounds      Int?
//   current_round   Int?
//   current_word_id Int?
//   word            Word?       @relation(fields: [current_word_id], references: [id])

//   wordsSorted WordSorted[]
//   guesses Guess[]
//   players Player[]
// }

// model Player {
//   id       Int     @id @default(autoincrement())
//   name     String
//   score    Int?
//   photo    String?
//   is_admin Boolean
//   room_id  Int
//   room     Room    @relation(fields: [room_id], references: [id])
//   id_socket String?
//   guesses  Guess[]
// }

// enum MusicApi {
//   genius
//   vagalume
//   musixmatch
// }

// model Guess {
//   id                 Int     @id @default(autoincrement())
//   artist_name        String
//   song_name          String
//   is_correct         Boolean?
//   selected_music_id  Int?
//   selected_music_api MusicApi?
//   player_id          Int
//   player             Player  @relation(fields: [player_id], references: [id])
//   room_id            Int
//   room               Room    @relation(fields: [room_id], references: [id])
// }

// model Word {
//   id          Int      @id @default(autoincrement())
//   word        String
//   language_id Int
//   language    Language @relation(fields: [language_id], references: [id])
//   wordSorted WordSorted[]

//   Rooms Room[]
// }

// model WordSorted {
//   id      Int    @id @default(autoincrement())
//   word_id Int
//   word    Word   @relation(fields: [word_id], references: [id])
//   room_id Int
//   room    Room   @relation(fields: [room_id], references: [id])
// }
